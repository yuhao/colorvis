<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.88.1">
    <title>Chromaticity and Gamut</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/5.1/examples/headers/">

    <!-- Bootstrap core CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">


    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
    </style>

    
    <!-- Custom styles for this template -->
    <link href="headers.css" rel="stylesheet">

    <!-- JavaScript -->
    <script src='https://cdn.plot.ly/plotly-2.4.2.min.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/3.2.1/math.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.0.2/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-zoom/1.1.1/chartjs-plugin-zoom.min.js"></script>
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js'></script>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            displayMath: [ ['$$','$$'], ['\[','\]'] ]
          }
        });
        MathJax.Hub.Register.StartupHook("End",function () {
          console.log("Mathjax loaded");
          console.log(typeof MathJax);
          MathJax.Hub.Queue(["Typeset", MathJax.Hub, "TFS"]);
        });
    </script>
  </head>
  <body>

<main>
  <div class="container">
    <header class="d-flex flex-wrap justify-content-center pt-3 mb-4 border-bottom">
      <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none">
        <h2>Tutorial 2: Chromaticity and Gamut</h2>
      </a>
    </header>

    <div class="d-grid gap-3 pt-3 mb-4 px-4 bg-light border rounded-3">
      <div class="row">
        <h3>Introduction</h3>
      </div>
    </div>

    <div class="d-grid gap-3 pt-3 mb-4 px-4 bg-light border rounded-3">
      <div class="row">
        <h3>Step 0: Picking a Color Space</h3>
        <p>While the notions of chromaticity and gamut are general, every color space has a different gamut and the same light has different chromaticities in different color spaces. To be concrete, we will use a specific color space for this tutorial. Any color space will do, so we invite you to build your own and use it to drive the rest of the tutorial. We know that a color space is uniquely defined by its primaries and the reference white. For simplicity, we will assume CIE Standard Illuminant E (Equal-Energy White) as the reference white, and provide you three ways to pick the primaries.</p>
        <ul style="list-style-type:none;">
          <li><input type="radio" value="usePreset" name="prim"><label for="usePreset">&nbsp;&nbsp;<b>Use Preset Primaries</b></label>. This is a short-cut that automatically selects spectral lights $435~nm$, $545~nm$, and $700~nm$ as the primaries.</li>
          <li><input type="radio" value="selPrim" name="prim"><label for="selPrim">&nbsp;&nbsp;<b>Select Spectral Primaries</b></label>. This will allow you to select three spectral lights as the primaries, exactly like what you did in the previous tutorial.</li>
          <li><input type="radio" value="drawPrim" name="prim"><label for="drawPrim">&nbsp;&nbsp;<b>Draw Primaries</b></label>. You can draw the spectral power distribution (SPD) of the primaries in the right chart below. You can <button id="resetPrim" class="btn btn-primary btn-sm" disabled>Reset Draw</button> to start over.</li>
        </ul>
      </div>

      <div class="row">
        <div class="col-sm-6">
          <canvas id="canvasLMS"></canvas>
        </div>
        <div class="col-sm-6">
          <canvas id="canvasRGBPrim"></canvas>
        </div>
      </div>
      <p>Once the color space is built, we can <button id="plotLocus" class="btn btn-primary btn-sm" disabled>Plot Spectral Locus</button> in the color space. The locus is calculated, under the hood, by calculating the Color Matching Functions (CMFs) using the method we explored in the previous tutorial.</p>
    </div>

    <div class="d-grid gap-3 pt-3 mb-4 px-4 bg-light border rounded-3">
      <div class="row">
        <h3>Step 1: Decoupling Quality and Quantity from a Color</h3>
        <p>The plot below is the spectral locus in your RGB space. Hover over any point on the locus to reveal the coordinates of the corresponding spectral light. Recall what the coordinates mean: they represent the amount of primaries needed to match the color of that spectral light. In fact, any point in this space corresponds to a color, and the coordinates of the point represent the amount of primaries needed to match that color.</p>
      </div>

      <div class="row">
        <div class="col-sm-4 d-flex align-self-center">
          <div>
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" role="switch" id="showChrm" disabled>
              <label class="form-check-label" for="showChrm">&nbsp;&nbsp;<b>Show Chromaticity Diagram</b></label>
            </div>
            <div class="form-check form-switch align-self-center">
              <input class="form-check-input" type="checkbox" role="switch" id="showPlane" disabled>
              <label class="form-check-label" for="showPlane">&nbsp;&nbsp;<b>Show r+g+b=1 Plane</b></label>
            </div>
            <div class="form-check form-switch align-self-center">
              <input class="form-check-input" type="checkbox" role="switch" id="showPrims" disabled>
              <label class="form-check-label" for="showPrims">&nbsp;&nbsp;<b>Show Primaries</b></label>
            </div>
          </div>
        </div>
        <div class="col-sm-8">
          <div id="rgbLocusDiv" class="mb-4"></div>
        </div>
      </div>

      <div class="row">
        <p>Now click any spectral light, a line that connects the spectral light with the origin will be shown. You will see that all the points on the same line, while requiring different absolute amounts of RGB primaries, all have the same R:G:B ratio. This is just a natural implication of points on a straight line in a 3D space. This conclusion generalizes too any line, not just the lines that go through the locus.</p>
        <p>How do a color that's mixed from 1:2:4 units of RGB primaries and a color that's mixed from a 2:4:8 units of the primaries relate? Well, recall from the previous tutorial that the amount of a primary is directly proportional to the power of that primary. So the second color can be obtained by doubling the power of each primary in the first color; similarly, halving the power of each primary in the second color gets us the first color. Intuitively, lights that have the same primary quantity ratio are said to have the same "objective color quality" while differing in the intensity.</p>
        <h4>Chromaticities</h4>
        <p>More formally, we calculate the primary ratio $r:g:b$ of a color and then normalize it such that $r+g+b = 1$ (100%). The so-calculated $r, g, b$ values of a color are called the <b>chromaticity</b> of that color. Mathematically, the chromaticities of a color are calculated from its absolute quantity by:</p>
        <p>$r = \frac{R}{R+G+B},~~~g = \frac{G}{R+G+B},~~~b = \frac{B}{R+G+B}$.</p>
        <p>Obviously, the chromaticities of a color depend on the particular color space used to represent that color.</p>
        <p>Knowing the chromaticities of a color tells us the objective quality of the color, and we can make that color brighter or darker by increasing or decreasing the amount of the primaries <i>while keeping the chromaticities constant</i>. In many practical color applications such as color photography and digital displays, chromaticities of a color is what we strive to capture (in the case of photography) and reproduce (in the case of display), and we are almost never be able to capture/reproduce the exact intensity of light in the scene (think about the power of the sun!).</p>
        <h4>Understanding Chromaticity Plot</h4>
        <p>Each color now has an rgb triplet. Similar to how we represent colors in the RGB space, we can plot the colors in the rgb space, which we call the chromaticity plot. Click "Show Chromaticity Plot" and you will see the spectral locus in the chromaticity plot. Spin around the curve. Notice how all the spectral lights are now on the same plane. That's the natural implication of how chromaticities are defined: since we enforce $r+g+b=1$, all the colors in the chromaticity plot naturally lie on the $r+g+b=1$ plane. If we were to define chromaticities such that $r+g+b=1.5$, all the colors will then lie on that plane.</p>
        <p>One way to think of the chromaticity plot is that we have projected all the colors in the RGB space to a plane; each RGB point is projected by connecting the origin with the RGB point and finding the intersection of that line with the plane.</p>
      </div>
    </div>

    <div class="b-example-divider"></div>
  </div>


</main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>

    <script src="chrm.js"></script>
  </body>
</html>
