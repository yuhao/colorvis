<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.88.1">
    <title>CMF From Cone Fundamentals</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/5.1/examples/headers/">

    <!-- Bootstrap core CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">


    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
    </style>

    
    <!-- Custom styles for this template -->
    <link href="headers.css" rel="stylesheet">

    <!-- JavaScript -->
    <script src='https://cdn.plot.ly/plotly-2.4.2.min.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/3.2.1/math.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.0.2/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-zoom/1.1.1/chartjs-plugin-zoom.min.js"></script>
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js'></script>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            displayMath: [ ['$$','$$'], ['\[','\]'] ]
          }
        });
        MathJax.Hub.Register.StartupHook("End",function () {
          console.log("Mathjax loaded");
          console.log(typeof MathJax);
          MathJax.Hub.Queue(["Typeset", MathJax.Hub, "TFS"]);
        });
    </script>
  </head>
  <body>

<div id="dialog-content" style="display:none;">
  <h2>Interaction Guide</h2>
  <p>Move your mouse to hover the charts, both the 2D and the 3D ones. You will see the LMS sensitivities at each wavelength in the tooltip. Notice that the corresponding point on the spectral locus in the 3D chart will be highlighted as you hover the 2D chart.</p>
  <p>Point your mouse at a particular point on any of the curves in the 2D chart, you can then start dragging the curve to build a set of new, hypothetical LMS cone fundamentals. Notice that the LMS spectral locus on the right will change too. If you do so, the rest of the steps in this tutorial will assume the new set of cone fundamentals.</p>
  <p>You can zoom the 2D chart by scrolling the mouse. You get to interact with the 3D plot with a lot more freedom, both zooming and panning as well as navigating the space by dragging the plot. If you hover your mouse over to the top-right corner of the 3D plot, a control panel will show up with more options.</p>
  </p>
</div>

<main>
  <div class="container">
    <header class="d-flex flex-wrap justify-content-center pt-3 mb-4 border-bottom">
      <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none">
        <h2>Tutorial 1: Deriving Color Matching Functions From Cone Fundamentals</h2>
      </a>
    </header>

    <div class="d-grid gap-3 pt-3 mb-4 px-4 bg-light border rounded-3">
      <div class="row">
        <h3>Introduction</h3>
        <p>This tutorial shows you how to build a color space from the cone fundamentals by deriving the Color Matching Functions (CMFs) of a color space. We explore the linear transformation between the cone fundamentals and the CMFs, which allows you to understand why human vision is (mostly) trichromatic. You will get to appreciate the critical but subtle difference between absolute quantity of light (e.g., radiance) and relative units used in a particular color space, and the importance of the reference white in a color space.</p>
        <p>The tutorial is interactive, which means you get to build the CMFs step by step yourself, but you have to <b>follow the steps</b>! You get to pick the primaries and the reference white, and can even build your own exotic LMS cone fundamentals to drive the rest of the tutorial. You will see some of the fields in the texts are initially ${\boxed{??}}$. They are numbers that depend on your actions, e.g., the selection of the primaries, and will be dynamically updated as you go.</p>
        <p><b>Caveats</b>: this is not how the CIE 1931 RGB CMFs are derived. We describe that process in this <a href="http://yuhaozhu.com/blog/cmf.html">post</a>. Among many tricky details, CIE 1931 RGB CMFs did not make use of the cone fundamentals; they started from earlier color matching experiments (by <a href="https://www.colour.org.uk/w-d-wright-obituary/">William David Wright</a> and <a href="https://link.springer.com/chapter/10.1007/978-3-319-30811-1_64">John Guild</a>) that provided the chromaticity coordinates, adjusted the primaries and the reference white, and used the CIE 1924 photopic lumininous efficiency function to convert the chromaticity coordinates to absolute quantities.</p>
        <p>Modern-day research usually experimentally obtain both the cone fundamentals and the CMFs and calibrate the results with each other to derive a best-fit linear transformation, which is then applied to the CMFs to derive a "clean" set of cone fundamentals. In fact, the cone fundamentals that we will use in this tutorial are derived that way. See, for instance, <a href="https://www.osapublishing.org/josaa/fulltext.cfm?uri=josaa-10-12-2491&id=4871">Stockman et al. (1993)</a> and <a href="https://www.sciencedirect.com/science/article/pii/S0042698900000213">Stockman and Sharpe (2000)</a>.</p>
      </div>
    </div>

    <div class="d-grid gap-3 pt-3 mb-4 px-4 bg-light border rounded-3">
      <div class="row">
        <h3>Step 0: Understanding the LMS Cone Fundamentals</h3>
        <p>The chart above shows the spectral sensitivities of the three cone types (L, M, and S), which are also called the cone fundamentals. The sensitivity chart tells us the amount of cone responses (y-axis) stimulated from different spectral lights (x-axis) that have the same energy/power/radiance. The absolute values of the responses don't matter, and they are customarily normalized to peak at unity. By treating the LMS responses of a spectral light as its 3D coordinates and then plot the spectral lights in the 3D space, we get what's called the <i>spectral locus</i>, which is shown in the plot on the right.</p>
        <p>The specific cone fundamentals we use are the <a href="http://cvrl.ioo.ucl.ac.uk/cones.htm">2-deg fundamentals by Stockman and Sharpe (2000)</a>, which is originally given between $390~nm$ and $830~nm$ at a $5~nm$ inverval. We clip anything beyond $780~nm$ and replicate the data at $390~nm$ for $380~nm$ and $385~nm$. You might sometimes see <a href="http://cvrl.ioo.ucl.ac.uk/conerequest_ss2.php">a different version</a> of the cone sensitivities, where the y-axis is in log-scale and the x-axis is equal-quantal rather than equal-energy. "Equal quantal" means the cone responses are given assuming the spectral lights have the same amount of photons rather than the same energy.</p>
      </div>
      <div class="row">
        <div class="col-sm-7">
          <canvas id="canvasLMS"></canvas>
          <div class="mb-4">
            <button id="resetChartLMS" class="btn btn-primary btn-sm">Reset</button>
            <button type="button" class="btn btn-primary btn-sm" data-bs-container="body" data-bs-toggle="popover" data-bs-placement="top" data-bs-content="Move your mouse to hover the charts to see the LMS sensitivities at each wavelength in the tooltip. Notice that the corresponding point on the spectral locus on the right will be highlighted as you hover over the 2D chart. You can zoom, pan, and spin the 3D plot. If you hover your mouse over to the top-right corner of the 3D plot, a control panel will show up with more options.">Help</button>
            <div class="form-check form-switch mt-2">
              <input class="form-check-input" type="checkbox" role="switch" id="drawPrim">
              <label class="form-check-label" for="drawPrim"><b>Draw Custom Cone Fundamentals.</b> Toggle this switch and start drawing your own cone fundamentals. By changing the LMS cone sensitivities, you are building an atypical kind of human being with unique color perception. </label>
            </div>
          </div>
        </div>
        <div class="col-sm-5">
          <div id="lmsDiv"></div>
        </div>
      </div>
    </div>

    <div class="d-grid gap-3 pt-3 mb-4 px-4 bg-light border rounded-3">
      <div class="row">
        <h2>Step 1: Pick the Primaries</h2>
        <p>The first step is to pick the primary lights of a color space. We provide you two ways to do so.</p>
        <ul style="list-style-type:none;">
          <li><input type="radio" value="usePreset" name="prim"><label for="usePreset">&nbsp;&nbsp;<b>Use Preset Primaries</b></label>. This is a short-cut that automatically selects spectral lights $445~nm$, $540~nm$, and $590~nm$ as the primaries.</li>
          <li><input type="radio" value="selPrim" name="prim"><label for="selPrim">&nbsp;&nbsp;<b>Select Spectral Primaries</b></label>. This will allow you to select three spectral lights as the primaries. The LMS chart above dims. You can then point the mouse at a point on a curve and click it to pick a primary. When you click a point, the L, M, and S responses at the corresponding wavelength are highlighted, indicating that one primary has been selected. The chart will lock once three primaries are selected. We assume that the first primary selected is the blue primary, the second one is green, and the last one is red. Of course R, G, and B are just names, but if you want the colors of the charts later to match your intuition, select the primaries from <b>left to right</b>. The primaries need not be spectral lights, but we limit ourselves to spectral lights in this tutorial for simplicity purposes.</li>
        </ul>
        <p>Once the primaries are selected, the following system of (three) linear equations are built. The system has the form $A_{3\times 3} \times M_{3\times n} = C_{3\times n}$, where $n$ is the number of spectral lights in the LMS chart, which is $81$ in our case, since the chart spans $380~nm$ to $780~nm$ at a $5~nm$ interval. This linear system lies at the heart of building RGB CMFs from the LMS cone fundamentals. Let's unpack it a bit more.</p>
        <p id="primText">
          ${}$ ${}$ ${}$ ${}$ ${}$ ${}$
        </p>
        <h4>Matching Cone Responses</h4>
        <p>This linear system essentially asks the following question: how much primary light each, in radiance, do we need to match the color of each spectral light under one unit radiance? The answer is encoded in matrix $M$, which is what we want to solve for.</p>
        <p>To answer this question, recall the key invariant in color science: to match color between two lights <b>their LMS cone responses must match</b>. Therefore, we will first express the LMS cone responeses of each spectral light, which is what matrix $C$ encodes. Each column vector in matrix $C$ corresponds to a spectral light, and represents the L, M, and S cone responses under one unit radiance of that spectral light. Naturally, numbers in each column are exactly the same as the numbers in the tooltip as you hover the mouse over the LMS chart above.</p>
        <div id="text1">
          <p>Matrix $M$ is what we want to solve for. Each column vector of matrix $M$ corresponds to a spectral light, and represents the amount (in radiance) of the three primary lights needed to match the color of that spectral light under one unit radiance. Without losing generality, let's take L cone and spectral light $500~nm$ as an example and ask: how much primary lights do we need to match the L cone response (${}$) of the spectral light at $500~nm$? That is, what are the values of $R_{500}, G_{500}, B_{500}$?</p>
          <p>For the color to match, the L cone response of the spectral light $500~nm$ must match the <i>total</i> L cone responses contributed by the three primary lights. The L cone response contribution of a primary light is: the radiance of the primary $\times$ L cone response per unit radiance of that primary. The former is what we solve for, and the latter can be directly read from the LMS chart above and is exactly what matrix $A$ encodes. Matrix $A$ is a $3 \times 3$ matrix, where the first row represents the amount of L cone responseses contributed by the three primaries per unit radiance; the second and third rows encode the same information, but for the M cone and the S cone, respectively.</p>
          <p>Naturally, matrix $A$ depends on what exactly the three primaries are. Before the primaries are selected, matrix $A$ is unknown (thus the question marks in the matrix). As you select your primaries, matrix $A$ will be dymamically updated. If you think about it, each column in matrix $A$ is same as the LMS cone responses of the corresponding wavelength in the LMS chart above. For instance, the first primary you choose is ${\boxed{??}}$ and the first column in matrix $A$ is ${\boxed{??}}$; if you hover the mouse at wavelength ${\boxed{??}}$, you will see the same three numbers.</p>
        </div>
        <h4>Trichromacy</h4>
        <p>Before we move on, take a look at the linear system above. It has the same number of unknowns and equations ($3 \times 81$), which, in general, leads to a unique solution, indicating that there is one unique way of mixing the primaries to match a target color. If we used more than 3, say 4, primaries, $A$ would be a $3 \times 4$ matrix, leading to an under-determined system ($A_{3\times 4} \times M_{4\times 81} = C_{3\times 81}$), meaning that there are, in general, infinite many ways of mixing the four primaries to match the color of an arbitrary light. In contrast, if we used fewer than 3, say 2, primaries, $A$ would be a $3 \times 2$ matrix, leading to an over-determined system ($A_{3\times 2} \times M_{2\times 81} = C_{3\times 81}$), meaning that that is no general way of mixing the two primaries to match the color of an arbitrary light.</p>
        <p>Fundamentally, the trichromatic theory of color has to do with the fact that human has three types of cone cells. Certain species have four cone cells, leading to <a href="https://en.wikipedia.org/wiki/Tetrachromacy">tetrachromacy</a>. There are a small population of people who have only one or two types of cone cells; they are monochromatic and dichromatic, respectively. Monochromatic people are completely color blind. That's also the reason your color perception is very weak just before dawn or right after sunset, when your cone cells are inactive and only rods are activated; there is only type of rod cells, hence no color perception. Interestingly, actual LMS cone sensitivities can be measured from monochromatic and dichromatic people, because they, in theory, allow us to isolate the responses of different cone types. See, for instance, <a href="https://www.sciencedirect.com/science/article/pii/S0042698900000213">Stockman and Sharpe (2000)</a>.</p>
      </div>
    </div>

    <div class="d-grid gap-3" style="grid-template-columns: 2fr 2fr;">
      <div class="bg-light border rounded-3 pt-3 mb-4 px-4">
        <div class="row">
          <h2>Step 2: Solve the Linear System</h2>
          <p>Once the three primaries are selected, matrix $A$ will be populated. Click <button id="solLinSys" class="btn btn-primary btn-sm" disabled>Solve and Plot</button> to solve the linear system and plot the resulting matrix $M$.</p>
          <canvas id="canvasUnscaledCMF"></canvas>
        </div>
        <div class="row pt-4">
          <h4>How to Interpret the Chart:</h4>
          <p id="text2">The figure above is not quite your color matching functions yet. The triplets at each wavelength tells us how much <b>radiance</b> of the primary lights we need to mix in order to match the color of <b>one unit radiance</b> (that is, $1 \frac{W}{m^{2} \cdot sr}$) of that spectral light. For instance, to match the color of $1 \frac{W}{m^{2} \cdot sr}$ of spectral light $500~nm$, we need to mix ${\boxed{??}}$ $\frac{W}{m^{2} \cdot sr}$ of the red primary, ${\boxed{??}}$ $\frac{W}{m^{2} \cdot sr}$ of the green primary, and ${\boxed{??}}$ $\frac{W}{m^{2} \cdot sr}$ of the blue primary. Hover your mouse over the chart above at $500~nm$ to confirm this. This is a natural implication of solving the linear system on the left, where matrix $C$ encodes the cone responsese of one unit radiance of each spectral light.</p>
          <p>Instead of referring to radiances, the CMFs tell us how many <b>units</b> of each primary light to mix. How is one unit of, say red primary, related to the radiance? It <i>could</i> be arbitrary. Nothing prevents us from calling $1 \frac{W}{m^{2} \cdot sr}$ radiance as one unit of red primary, or $19.5 \frac{W}{m^{2} \cdot sr}$ radiance as one unit of green, or $5,000 \frac{W}{m^{2} \cdot sr}$ radiance as one unit of blue. Instead of picking arbitrary numbers, we will define an intuitive unit system: equal units of the primaries light should match the color of the "white light". This is still somewhat arbitrary but certainly intuitive: we naturally expect white to be produced from mixing equal amount of primary lights.</p>
          <p>Give this understanding, two steps still remain before we can produce the final CMFs from the radiance chart above: 1) picking a light to represent white (step 3), and 2) converting radiance to units based on the chosen white light (step 4).</p>
        </div>
      </div>
      <div class="bg-light border rounded-3 pt-3 mb-4 px-4">
        <div class="row">
          <h2>Step 3: Pick the White</h2>
          <select id="whiteSel" style="width: 150px" class="my-2 form-select">
            <option value="D65">D65</option>
            <option value="A">A</option>
            <option value="E">E</option>
            <option value="Custom">Custom</option>
          </select>
        </div>
        <div class="row">
          <canvas id="canvasWhite"></canvas>
        </div>
        <div class="row pt-4">
          <h4>What is White?</h4>
          <p>White, as common as it is, does not refer to a specific light. Instead, many different light spectra are perceived "white-ish" and can be used as the reference white. CIE publishes a set of so-called <a href="https://en.wikipedia.org/wiki/Standard_illuminant">Standard Illuminants</a>, which are commonly used as reference whites for color spaces. For instance, Standard Illuminant D65 resembles noon daylight and is used in the sRGB color space among others; Standard Illuminant A resembles incandescent light. A special Standard Illuminant E, a.k.a., Equal-Energy White, has a flat SPD; it is used as the reference white in the CIE 1931 RGB color space and the CMFs.</p>
          <p>Use the select box above to choose between D65, A, and E. You can also draw your own reference white. The original SPDs in the CIE standard are normalized to a value of 100 at the wavelength of $560~nm$. For simplicity, we normalize the SPDs such that the peak is 1.0. That is, the maximum radiance of each illuminant is $1 \frac{W}{m^{2} \cdot sr}$.</p>
        </div>
      </div>
    </div>

    <div class="d-grid gap-3 pt-3 mb-4 px-4 bg-light border rounded-3">
      <div class="row">
        <h2>Step 4: Generate Color Matching Functions!</h2>
        <div id = "text4">
          <p>Given the specific white, we can now convert the radiance chart above to the CMFs. Here is the process. We first calculate how many primary lights in terms of <i>radiance</i> are needed to match the color of the given white. We can <button id="calcCMFScale" class="btn btn-primary btn-sm" disabled>Calculate</button> this by:</p>
            <p>$\sum_{380}^{780}W(\lambda)R(\lambda)$ = ${\boxed{??}}$,</p>
            <p>$\sum_{380}^{780}W(\lambda)G(\lambda)$ = ${\boxed{??}}$,</p>
            <p>$\sum_{380}^{780}W(\lambda)B(\lambda)$ = ${\boxed{??}}$,</p>
          <p>for $\lambda\in[380~nm, 780~nm]$ at a $5~nm$ interval; $W(\lambda)$ is the SPD of the white you choose on the left; and $R(\lambda)$, $G(\lambda)$, and $B(\lambda)$ are the spectral radiance curves plotted above.</p>
          <p>Under the white and the primaries that you selected, the calculation shows that we need to mix ${\boxed{??}}$$\frac{W}{m^{2} \cdot sr}$ of red primary, ${\boxed{??}}$$\frac{W}{m^{2} \cdot sr}$ of green primary, and ${\boxed{??}}$$\frac{W}{m^{2} \cdot sr}$ of blue primary, in order to match the color of $1 \frac{W}{m^{2} \cdot sr}$ of the chosen white.</p>
          <p>As established earlier, the unit system is so defined that white color is produced by mixing <i>equal units of the primary lights</i>. Therefore, ${\boxed{??}}$$\frac{W}{m^{2} \cdot sr}$ of the red primary, ${\boxed{??}}$$\frac{W}{m^{2} \cdot sr}$ of the green primary, and ${\boxed{??}}$$\frac{W}{m^{2} \cdot sr}$ of the blue primary must correspond to the same unit of the three primaries. Do they correspond to 1 unit each, 10 units each, or 1 million units each? Doesn't matter, if we care about just the ratio of the primary quantities, as is often the case in colorimetry.</p>
          <!--The way the CIE 1931 RGB CMFs worked out, they essentially assumed that 1 unit of primaries match the color of $3.782 \frac{W}{m^{2} \cdot sr}$ reference white.-->
          <p>For simplicity, here we will just assume that $1 \frac{W}{m^{2} \cdot sr}$ reference white is matched with exactly 1 unit of the three primaries. Therefore, to convert from radiance to units, we would simply divide each red radiance value in the chart above by ${\boxed{??}}$, each green radiance value by ${\boxed{??}}$, and each blue radiance value by ${\boxed{??}}$. The results are the CMFs, which are usually denoted as $\bar{r}$, $\bar{g}$, and $\bar{b}$.</p>
          <p>$\bar{r}(\lambda) = R(\lambda)/$
             ${\boxed{??}},$
             $~~~\bar{g}(\lambda) = G(\lambda)/$
             ${\boxed{??}},$
             $~~~\bar{b}(\lambda) = B(\lambda)/$
             ${\boxed{??}}$
             $,~~~\lambda \in [380~nm, 780~nm]$</p>
          <p>Or in the matrix form:
          $\begin{bmatrix}
           \bar{r}(\lambda) \\
           \bar{g}(\lambda) \\
           \bar{b}(\lambda)
          \end{bmatrix} = $
          ${\boxed{??}}$
          $\times \begin{bmatrix}
           R(\lambda) \\
           G(\lambda) \\
           B(\lambda)
          \end{bmatrix}$
          </p>
          <p>Let's <button id="plotScaleCMF" class="btn btn-primary btn-sm" disabled>Plot the CMFs</button>. If you make changes to the cone fundamentals or the white light, click the calculate and the plot buttons again; the new CMFs will be updated.</p>
        </div>
      </div>
    </div>

    <div class="d-grid gap-3 pt-3 mb-4 px-4 bg-light border rounded-3">
      <div class="row">
        <h2>Step 5: Interpret the Results</h2>
      </div>

      <div class="row">
        <div class="col-sm-7">
          <canvas id="canvasCMF"></canvas>
        </div>
        <div class="col-sm-5">
          <div id="rgbDiv"></div>
          <div class="d-flex justify-content-center">
            <button id="RGB2rgb" class="btn btn-primary btn-sm" disabled>Locus in Chromaticity</button>
            <button id="rgb2RGB" class="btn btn-success btn-sm" disabled>Locus in RGB</button>
            <button id="showPrim" class="btn btn-info btn-sm" disabled>Show Primaries</button>
          </div>
        </div>
      </div>

      <div class="row">
        <h4>The Locus in the RGB Space</h4>
        <div id="cmftext">
          <p>The triplets at each wavelength in the CMFs tells us how many <b>units</b> of the primary lights are needed in order to match the color of <b>one unit radiance</b> ($1 \frac{W}{m^{2} \cdot sr}$) of that spectral light. We call them the <i>tristimulus values</i> of that spectral light in a color space. Using the tristimulus values as the 3D coordinates we can plot all the spectral lights, which is shown in the plot on the right.</p>
          <p>Click the "Show Primaries" button and confirm that the three primary lights sit on the axes, each on one axis. What this means is that, naturally, to match the color of a primary light you would not need any amount of the other two primaries. For instance, the "blue" primary you choose is ${\boxed{??}}$; the RGB tristimulus values of that light are ${\boxed{??}}$, ${\boxed{??}}$, and ${\boxed{??}}$ &#8212; the first two values being 0 (If you see something like $-0.000$, that's just a very small negative number that get's rounded to 0, but the negative sign still sticks around). Note that the value for the blue primary isn't 1. Nothing wrong with that; it means you need ${\boxed{??}}$ units of ${\boxed{??}}$ to match $1 \frac{W}{m^{2} \cdot sr}$ of ${\boxed{??}}$.</p>
        </div>
        <h4>What Does an Arbitrary Point in the RGB Space Mean?</h4>
        <div>
        </div>
        <h4>Linear Transformation Between Color Spaces</h4>
        <div>
          <p>Every light has a set of LMS tristimulus values and so is a point in the LMS space; it has another set of RGB tristimulus values and is a point in the RGB space just built. How do points in the LMS space and points in the RGB space relate? The math we have done so far dictates that the relationship must be a linear transformation. In particular, the LMS value of a light and the RGB value of the light <i>in your color space</i> are related by:</p>
          <p id="text5">
          $\begin{bmatrix}
           L \\
           M \\
           S
          \end{bmatrix} = T 
          \times \begin{bmatrix}
           R \\
           G \\
           B
          \end{bmatrix}$, where
          $T = $ $\boxed{??}$
          </p>
          <p>The linear transformation is formed by a combination of two intermediate transformations, one in Step 1 and the other (scaling) in Step 4.</p>
          <p>The exact linear transformation from LMS to RGB depends on the specific RGB space. But regardless of what RGB space you build, the transformation from/to LMS is linear. What this further means is that any two RGB color spaces are also related by just one single linear transformation. If a color space $RGB_1$ is transformed from the LMS space by $T_1$ and another color space $RGB_2$ is transformed from the LMS space by $T_2$, then $RGB_1$ can be transformed from $RGB_2$ by $T_1^{-1}T_2$.</p>
          <p>In this sense, LMS is a color space, too. The primaries in the LMS space, however, are imaginary, physically unrealizable lights, each of which stimulates exclusively only one cone type. The fact that the LMS primaries are not physically realizable is evident when looking at the 3D LMS space. Spin around the second plot in Step 0; you will see that the spectral locus does not intersect any of the axes, which are where the LMS primaries would lie. Note that the spectral locus does intersect the <b>origin</b> of the LMS space; invisible (but physically realizable) lights such as IR or UV lie there.</p>
          <p>If you use the original cone fundamentals (i.e., did not drive this experiment using your own exotic cone fundamentals) and the primaries are nicely spread across the spectrum, you will likely see that the chromaticity gamut of your color space (the triangle formed by the primaries) does <i>not</i> include any other spectral light except the primaries. This shows that no other spectral light can be produced from your RGB color space, which is generally true for any RGB color space.</p>
        </div>
      </div>

    </div>

  <div class="b-example-divider"></div>
  </div>


</main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>

    <script src="cmf.js"></script>
  </body>
</html>
